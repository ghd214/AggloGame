/*! Agglo2 10-03-2015 */
function Expander(){view.size;this.expander=new Path.Circle({x:event.point.x,y:event.point.y},5),expander.fillColor="#7fddc0"}function Bullet(){var a=view.size,b=4;this.radius=4,this.point=Point.random(),this.point.x=this.point.x*a.width,this.point.y=this.point.y*a.height,this.vector=new Point({angle:360*Math.random(),length:b}),this.circle=new Path.Circle({x:this.point.x,y:this.point.y},this.radius),this.circle.fillColor="red"}function Expander(a){this.point=a.point,this.expander=new Path.Circle({x:this.point.x,y:this.point.y},this.initialWidth),this.expander.fillColor="#7fddc0"}Expander.prototype={},Bullet.prototype={iterate:function(){this.checkBorders(),this.move()},checkBorders:function(){size=view.size,this.point.x<this.radius&&(this.point.x=this.radius,this.vector.x=-this.vector.x),this.point.x>size.width-this.radius&&(this.point.x=size.width-this.radius,this.vector.x=-this.vector.x),this.point.y<this.radius&&(this.point.y=this.radius,this.vector.y=-this.vector.y),this.point.y>size.height-this.radius&&(this.point.y=size.height-this.radius,this.vector.y=-this.vector.y)},move:function(){this.point.x+=this.vector.x,this.point.y+=this.vector.y,this.circle.position={x:this.point.x,y:this.point.y}}},Expander.prototype={baseScale:1,shrinkScale:.95,initialWidth:5},Expander.prototype.iterate=function(){this.checkBorders(),this.move()},Expander.prototype.checkBorders=function(){var a=view.size,b=this.expander.bounds;b.x>1&&b.y>1&&b.x+b.width<a.width-1&&b.y+this.expander.bounds.height<a.height-1?this.expand():(b.x<0||b.y<0||b.x+b.width>a.width||b.y+this.expander.bounds.height>a.height)&&this.reduce()},Expander.prototype.checkCollisions=function(){},Expander.prototype.pop=function(){},Expander.prototype.expand=function(){var a=this.expander.bounds.width/2,b=this.baseScale+this.baseScale/a;this.expander.scale(b)},Expander.prototype.reduce=function(){this.expander.scale(this.shrinkScale)},Expander.prototype.move=function(){this.expander.position=this.point};var Agglo=function(){return this.init=function(a){paper.install(window),paper.setup("game");for(var b=new Tool,c=paper.project.view,d=[],e=a||1,f=null,g=function(){c.setViewSize(c.size.width,c.size.width/2)},h=function(a){console.log("You pressed the mouse!"),f=new Expander(a)},i=function(a){console.log("dragging..."),f.point=a.point},j=function(){console.log("You released the mouse!"),f=null},k=function(){for(var a=d.length-1;a>=0;a--)d[a].iterate();f&&f.iterate()},l=e-1;l>=0;l--)d.push(new Bullet);g(),b.onMouseUp=j,b.onMouseDown=h,b.onMouseDrag=i,c.onResize=g,c.onFrame=k},{run:this.init}}();window.onload=function(){Agglo.run(5)};